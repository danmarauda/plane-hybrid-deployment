import{r as o,o as e,w as E}from"./chunk-UIGDSWPH-DWOOOxqk.js";import{I as W,O as j,W as _,R as T,o as z}from"./store.provider-C9rYaGrA.js";import{L as U}from"./link-CvXtRfRL.js";import{u as I}from"./navigation-BHLSI9iT.js";import{u as B,C as i}from"./index.esm-XeU7nagb.js";import{B as O,g as q}from"./button-CJES52DI-LZmtqnY7.js";import{s as n,a as m}from"./index-BVHUuPnE.js";import{I as k,x as v}from"./index-vgvgxTJM.js";import{u as P}from"./use-workspace-B7avqqlp.js";import"./index-Dq3cOres.js";import"./helper-CmYjNUif.js";import"./classname-iNHf9Pb8-5LSAqF-w.js";import"./index-CzOQsu2R.js";const V=new W;function A(){const d=I(),[u,x]=o.useState(!1),[y,p]=o.useState(!1),[N,h]=o.useState({name:"",slug:"",organization_size:""}),{createWorkspace:S}=P(),{handleSubmit:b,control:c,setValue:g,getValues:f,formState:{errors:t,isSubmitting:w,isValid:C}}=B({defaultValues:N,mode:"onChange"}),R=encodeURI(_),L=async s=>{await V.slugCheck(s.slug).then(async r=>{r.status===!0&&!T.includes(s.slug)?(x(!1),await S(s).then(async()=>{n({type:m.SUCCESS,title:"Success!",message:"Workspace created successfully."}),d.push("/workspace")}).catch(()=>{n({type:m.ERROR,title:"Error!",message:"Workspace could not be created. Please try again."})})):x(!0)}).catch(()=>{n({type:m.ERROR,title:"Error!",message:"Some error occurred while creating workspace. Please try again."})})};return o.useEffect(()=>()=>{h(f())},[f,h]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid-col grid w-full max-w-4xl grid-cols-1 items-start justify-between gap-x-10 gap-y-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h4",{className:"text-sm text-custom-text-300",children:"Name your workspace"}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx(i,{control:c,name:"name",rules:{required:"This is a required field.",validate:s=>/^[\w\s-]*$/.test(s)||'Workspaces names can contain only (" "), ( - ), ( _ ) and alphanumeric characters.',maxLength:{value:80,message:"Limit your name to 80 characters."}},render:({field:{value:s,ref:r,onChange:a}})=>e.jsx(k,{id:"workspaceName",type:"text",value:s,onChange:l=>{a(l.target.value),g("name",l.target.value),g("slug",l.target.value.toLocaleLowerCase().trim().replace(/ /g,"-"),{shouldValidate:!0})},ref:r,hasError:!!t.name,placeholder:"Something familiar and recognizable is always best.",className:"w-full"})}),e.jsx("span",{className:"text-xs text-red-500",children:t?.name?.message})]})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h4",{className:"text-sm text-custom-text-300",children:"Set your workspace's URL"}),e.jsxs("div",{className:"flex gap-0.5 w-full items-center rounded-md border-[0.5px] border-custom-border-200 px-3",children:[e.jsx("span",{className:"whitespace-nowrap text-sm text-custom-text-200",children:R}),e.jsx(i,{control:c,name:"slug",rules:{required:"The URL is a required field.",maxLength:{value:48,message:"Limit your URL to 48 characters."}},render:({field:{onChange:s,value:r,ref:a}})=>e.jsx(k,{id:"workspaceUrl",type:"text",value:r.toLocaleLowerCase().trim().replace(/ /g,"-"),onChange:l=>{/^[a-zA-Z0-9_-]+$/.test(l.target.value)?p(!1):p(!0),s(l.target.value.toLowerCase())},ref:a,hasError:!!t.slug,placeholder:"workspace-name",className:"block w-full rounded-md border-none bg-transparent !px-0 py-2 text-sm"})})]}),u&&e.jsx("p",{className:"text-sm text-red-500",children:"This URL is taken. Try something else."}),y&&e.jsx("p",{className:"text-sm text-red-500",children:"URLs can contain only ( - ), ( _ ) and alphanumeric characters."}),t.slug&&e.jsx("span",{className:"text-xs text-red-500",children:t.slug.message})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("h4",{className:"text-sm text-custom-text-300",children:"How many people will use this workspace?"}),e.jsxs("div",{className:"w-full",children:[e.jsx(i,{name:"organization_size",control:c,rules:{required:"This is a required field."},render:({field:{value:s,onChange:r}})=>e.jsx(v,{value:s,onChange:r,label:j.find(a=>a===s)??e.jsx("span",{className:"text-custom-text-400",children:"Select a range"}),buttonClassName:"!border-[0.5px] !border-custom-border-200 !shadow-none",input:!0,children:j.map(a=>e.jsx(v.Option,{value:a,children:a},a))})}),t.organization_size&&e.jsx("span",{className:"text-sm text-red-500",children:t.organization_size.message})]})]})]}),e.jsxs("div",{className:"flex max-w-4xl items-center py-1 gap-4",children:[e.jsx(O,{variant:"primary",size:"sm",onClick:b(L),disabled:!C,loading:w,children:w?"Creating workspace":"Create workspace"}),e.jsx(U,{className:q("neutral-primary","sm"),href:"/workspace",children:"Go back"})]})]})}const G=z(function(u){return e.jsxs("div",{className:"relative container mx-auto w-full h-full p-4 py-4 space-y-6 flex flex-col",children:[e.jsxs("div",{className:"border-b border-custom-border-100 mx-4 py-4 space-y-1 flex-shrink-0",children:[e.jsx("div",{className:"text-xl font-medium text-custom-text-100",children:"Create a new workspace on this instance."}),e.jsx("div",{className:"text-sm font-normal text-custom-text-300",children:"You will need to invite users from Workspace Settings after you create this workspace."})]}),e.jsx("div",{className:"flex-grow overflow-hidden overflow-y-scroll vertical-scrollbar scrollbar-md px-4",children:e.jsx(A,{})})]})}),ae=()=>[{title:"Create Workspace - God Mode"}],te=E(G);export{te as default,ae as meta};
