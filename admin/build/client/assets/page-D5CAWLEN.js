import{r as b,o as e,w as v}from"./chunk-UIGDSWPH-DWOOOxqk.js";import{a as G,o as N}from"./store.provider-C9rYaGrA.js";import{u as S}from"./index-Dc4aw0qJ.js";import{s as k,a as w,b as T}from"./index-BVHUuPnE.js";import{w as A,L as s}from"./index-vgvgxTJM.js";import{G as D}from"./google-logo-C_szah0w.js";import{A as R}from"./authentication-method-card-QbZyRS5a.js";import{u as y}from"./use-instance-CkArE5we.js";import{L as B}from"./link-CvXtRfRL.js";import{u as P}from"./index.esm-XeU7nagb.js";import{B as F,g as M}from"./button-CJES52DI-LZmtqnY7.js";import{b as U}from"./index-CzOQsu2R.js";import{i as q,C as Y,a as C,b as I}from"./copy-field-B4xugwUu.js";import{C as W}from"./controller-input-Ch9fJpKv.js";import{M as z}from"./monitor-DbSW9kUQ.js";import"./index-Dq3cOres.js";import"./classname-iNHf9Pb8-5LSAqF-w.js";import"./helper-CmYjNUif.js";import"./transition-Cll_7jRI.js";import"./dialog-DvpWpn9V.js";import"./eye-CKm8Qo8U.js";function V(E){const{config:g}=E,[u,t]=b.useState(!1),{updateInstanceConfigurations:h}=y(),{handleSubmit:n,control:r,reset:l,formState:{errors:a,isDirty:c,isSubmitting:i}}=P({defaultValues:{GOOGLE_CLIENT_ID:g.GOOGLE_CLIENT_ID,GOOGLE_CLIENT_SECRET:g.GOOGLE_CLIENT_SECRET}}),d=q(G)?typeof window<"u"?window.location.origin:"":G,p=[{key:"GOOGLE_CLIENT_ID",type:"text",label:"Client ID",description:e.jsxs(e.Fragment,{children:["Your client ID lives in your Google API Console."," ",e.jsx("a",{tabIndex:-1,href:"https://developers.google.com/identity/protocols/oauth2/javascript-implicit-flow#creatingcred",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"Learn more"})]}),placeholder:"840195096245-0p2tstej9j5nc4l8o1ah2dqondscqc1g.apps.googleusercontent.com",error:!!a.GOOGLE_CLIENT_ID,required:!0},{key:"GOOGLE_CLIENT_SECRET",type:"password",label:"Client secret",description:e.jsxs(e.Fragment,{children:["Your client secret should also be in your Google API Console."," ",e.jsx("a",{tabIndex:-1,href:"https://developers.google.com/identity/oauth2/web/guides/get-google-api-clientid",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"Learn more"})]}),placeholder:"GOCShX-ADp4cI0kPqav1gGCBg5bE02E",error:!!a.GOOGLE_CLIENT_SECRET,required:!0}],x=[{key:"Origin_URL",label:"Origin URL",url:d,description:e.jsxs("p",{children:["We will auto-generate this. Paste this into your"," ",e.jsx(I,{darkerShade:!0,children:"Authorized JavaScript origins"})," field. For this OAuth client"," ",e.jsx("a",{href:"https://console.cloud.google.com/apis/credentials/oauthclient",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"here."})]})}],O=[{key:"Callback_URI",label:"Callback URI",url:`${d}/auth/google/callback/`,description:e.jsxs("p",{children:["We will auto-generate this. Paste this into your ",e.jsx(I,{darkerShade:!0,children:"Authorized Redirect URI"})," ","field. For this OAuth client"," ",e.jsx("a",{href:"https://console.cloud.google.com/apis/credentials/oauthclient",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"here."})]})}],j=async o=>{const _={...o};await h(_).then((m=[])=>{k({type:w.SUCCESS,title:"Done!",message:"Your Google authentication is configured. You should test it now."}),l({GOOGLE_CLIENT_ID:m.find(f=>f.key==="GOOGLE_CLIENT_ID")?.value,GOOGLE_CLIENT_SECRET:m.find(f=>f.key==="GOOGLE_CLIENT_SECRET")?.value})}).catch(m=>console.error(m))},L=o=>{c&&(o.preventDefault(),t(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{isOpen:u,onDiscardHref:"/authentication",handleClose:()=>t(!1)}),e.jsx("div",{className:"flex flex-col gap-8",children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-8 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 col-span-2 md:col-span-1 pt-1",children:[e.jsx("div",{className:"pt-2.5 text-xl font-medium",children:"Google-provided details for Plane"}),p.map(o=>e.jsx(W,{control:r,type:o.type,name:o.key,label:o.label,description:o.description,placeholder:o.placeholder,error:o.error,required:o.required},o.key)),e.jsx("div",{className:"flex flex-col gap-1 pt-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(F,{variant:"primary",onClick:n(j),loading:i,disabled:!c,children:i?"Saving...":"Save changes"}),e.jsx(B,{href:"/authentication",className:U(M("neutral-primary","md"),"font-medium"),onClick:L,children:"Go back"})]})})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1 flex flex-col gap-y-6",children:[e.jsx("div",{className:"pt-2 text-xl font-medium",children:"Plane-provided details for Google"}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("div",{className:"flex flex-col gap-y-4 px-6 py-4 bg-custom-background-80 rounded-lg",children:x.map(o=>e.jsx(C,{label:o.label,url:o.url,description:o.description},o.key))}),e.jsxs("div",{className:"flex flex-col rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-3 bg-custom-background-80/60 font-medium text-xs uppercase flex items-center gap-x-3 text-custom-text-200",children:[e.jsx(z,{className:"w-3 h-3"}),"Web"]}),e.jsx("div",{className:"px-6 py-4 flex flex-col gap-y-4 bg-custom-background-80",children:O.map(o=>e.jsx(C,{label:o.label,url:o.url,description:o.description},o.key))})]})]})]})]})})]})}const $=N(function(g){const{fetchInstanceConfigurations:u,formattedConfig:t,updateInstanceConfigurations:h}=y(),[n,r]=b.useState(!1),l=t?.IS_GOOGLE_ENABLED??"";S("INSTANCE_CONFIGURATIONS",()=>u());const a=async(c,i)=>{r(!0);const d={[c]:i},p=h(d);T(p,{loading:"Saving Configuration...",success:{title:"Configuration saved",message:()=>`Google authentication is now ${i==="1"?"active":"disabled"}.`},error:{title:"Error",message:()=>"Failed to save configuration"}}),await p.then(()=>{r(!1)}).catch(x=>{console.error(x),r(!1)})};return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative container mx-auto w-full h-full p-4 py-4 space-y-6 flex flex-col",children:[e.jsx("div",{className:"border-b border-custom-border-100 mx-4 py-4 space-y-1 flex-shrink-0",children:e.jsx(R,{name:"Google",description:`Allow members to login or sign up to plane with their Google
            accounts.`,icon:e.jsx("img",{src:D,height:24,width:24,alt:"Google Logo"}),config:e.jsx(A,{value:!!parseInt(l),onChange:()=>{parseInt(l)?a("IS_GOOGLE_ENABLED","0"):a("IS_GOOGLE_ENABLED","1")},size:"sm",disabled:n||!t}),disabled:n||!t,withBorder:!1})}),e.jsx("div",{className:"flex-grow overflow-hidden overflow-y-scroll vertical-scrollbar scrollbar-md px-4",children:t?e.jsx(V,{config:t}):e.jsxs(s,{className:"space-y-8",children:[e.jsx(s.Item,{height:"50px",width:"25%"}),e.jsx(s.Item,{height:"50px"}),e.jsx(s.Item,{height:"50px"}),e.jsx(s.Item,{height:"50px"}),e.jsx(s.Item,{height:"50px",width:"50%"})]})})]})})}),he=()=>[{title:"Google Authentication - God Mode"}],xe=v($);export{xe as default,he as meta};
