import{r as y,o as e,w as v}from"./chunk-UIGDSWPH-DWOOOxqk.js";import{a as _,o as S}from"./store.provider-C9rYaGrA.js";import{y as B}from"./index.module-D2LUA61L.js";import{u as k}from"./index-Dc4aw0qJ.js";import{s as H,a as w,b as U}from"./index-BVHUuPnE.js";import{w as A,L as s}from"./index-vgvgxTJM.js";import{b as D,r as L}from"./index-CzOQsu2R.js";import{g as O,a as R}from"./github-white-ChyV_wsU.js";import{A as F}from"./authentication-method-card-QbZyRS5a.js";import{u as G}from"./use-instance-CkArE5we.js";import{L as M}from"./link-CvXtRfRL.js";import{u as P}from"./index.esm-XeU7nagb.js";import{B as Z,g as q}from"./button-CJES52DI-LZmtqnY7.js";import{i as z,C as Y,a as C,b as N}from"./copy-field-B4xugwUu.js";import{C as W}from"./controller-input-Ch9fJpKv.js";import{M as V}from"./monitor-DbSW9kUQ.js";import"./index-Dq3cOres.js";import"./classname-iNHf9Pb8-5LSAqF-w.js";import"./helper-CmYjNUif.js";import"./transition-Cll_7jRI.js";import"./dialog-DvpWpn9V.js";import"./eye-CKm8Qo8U.js";function $(T){const{config:c}=T,[g,a]=y.useState(!1),{updateInstanceConfigurations:x}=G(),{handleSubmit:d,control:r,reset:I,formState:{errors:i,isDirty:m,isSubmitting:o}}=P({defaultValues:{GITHUB_CLIENT_ID:c.GITHUB_CLIENT_ID,GITHUB_CLIENT_SECRET:c.GITHUB_CLIENT_SECRET,GITHUB_ORGANIZATION_ID:c.GITHUB_ORGANIZATION_ID}}),u=z(_)?typeof window<"u"?window.location.origin:"":_,p=[{key:"GITHUB_CLIENT_ID",type:"text",label:"Client ID",description:e.jsxs(e.Fragment,{children:["You will get this from your"," ",e.jsx("a",{tabIndex:-1,href:"https://github.com/settings/applications/new",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"GitHub OAuth application settings."})]}),placeholder:"70a44354520df8bd9bcd",error:!!i.GITHUB_CLIENT_ID,required:!0},{key:"GITHUB_CLIENT_SECRET",type:"password",label:"Client secret",description:e.jsxs(e.Fragment,{children:["Your client secret is also found in your"," ",e.jsx("a",{tabIndex:-1,href:"https://github.com/settings/applications/new",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"GitHub OAuth application settings."})]}),placeholder:"9b0050f94ec1b744e32ce79ea4ffacd40d4119cb",error:!!i.GITHUB_CLIENT_SECRET,required:!0},{key:"GITHUB_ORGANIZATION_ID",type:"text",label:"Organization ID",description:e.jsx(e.Fragment,{children:"The organization github ID."}),placeholder:"123456789",error:!!i.GITHUB_ORGANIZATION_ID,required:!1}],f=[{key:"Origin_URL",label:"Origin URL",url:u,description:e.jsxs(e.Fragment,{children:["We will auto-generate this. Paste this into the ",e.jsx(N,{darkerShade:!0,children:"Authorized origin URL"})," field"," ",e.jsx("a",{tabIndex:-1,href:"https://github.com/settings/applications/new",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"here."})]})}],h=[{key:"Callback_URI",label:"Callback URI",url:`${u}/auth/github/callback/`,description:e.jsxs(e.Fragment,{children:["We will auto-generate this. Paste this into your ",e.jsx(N,{darkerShade:!0,children:"Authorized Callback URI"})," ","field"," ",e.jsx("a",{tabIndex:-1,href:"https://github.com/settings/applications/new",target:"_blank",className:"text-custom-primary-100 hover:underline",rel:"noreferrer",children:"here."})]})}],b=async t=>{const E={...t};await x(E).then((n=[])=>{H({type:w.SUCCESS,title:"Done!",message:"Your GitHub authentication is configured. You should test it now."}),I({GITHUB_CLIENT_ID:n.find(l=>l.key==="GITHUB_CLIENT_ID")?.value,GITHUB_CLIENT_SECRET:n.find(l=>l.key==="GITHUB_CLIENT_SECRET")?.value,GITHUB_ORGANIZATION_ID:n.find(l=>l.key==="GITHUB_ORGANIZATION_ID")?.value})}).catch(n=>console.error(n))},j=t=>{m&&(t.preventDefault(),a(!0))};return e.jsxs(e.Fragment,{children:[e.jsx(Y,{isOpen:g,onDiscardHref:"/authentication",handleClose:()=>a(!1)}),e.jsx("div",{className:"flex flex-col gap-8",children:e.jsxs("div",{className:"grid grid-cols-2 gap-x-12 gap-y-8 w-full",children:[e.jsxs("div",{className:"flex flex-col gap-y-4 col-span-2 md:col-span-1 pt-1",children:[e.jsx("div",{className:"pt-2.5 text-xl font-medium",children:"GitHub-provided details for Plane"}),p.map(t=>e.jsx(W,{control:r,type:t.type,name:t.key,label:t.label,description:t.description,placeholder:t.placeholder,error:t.error,required:t.required},t.key)),e.jsx("div",{className:"flex flex-col gap-1 pt-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Z,{variant:"primary",onClick:d(b),loading:o,disabled:!m,children:o?"Saving...":"Save changes"}),e.jsx(M,{href:"/authentication",className:D(q("neutral-primary","md"),"font-medium"),onClick:j,children:"Go back"})]})})]}),e.jsxs("div",{className:"col-span-2 md:col-span-1 flex flex-col gap-y-6",children:[e.jsx("div",{className:"pt-2 text-xl font-medium",children:"Plane-provided details for GitHub"}),e.jsxs("div",{className:"flex flex-col gap-y-4",children:[e.jsx("div",{className:"flex flex-col gap-y-4 px-6 py-4 bg-custom-background-80 rounded-lg",children:f.map(t=>e.jsx(C,{label:t.label,url:t.url,description:t.description},t.key))}),e.jsxs("div",{className:"flex flex-col rounded-lg overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-3 bg-custom-background-80/60 font-medium text-xs uppercase flex items-center gap-x-3 text-custom-text-200",children:[e.jsx(V,{className:"w-3 h-3"}),"Web"]}),e.jsx("div",{className:"px-6 py-4 flex flex-col gap-y-4 bg-custom-background-80",children:h.map(t=>e.jsx(C,{label:t.label,url:t.url,description:t.description},t.key))})]})]})]})]})})]})}const J=S(function(c){const{fetchInstanceConfigurations:g,formattedConfig:a,updateInstanceConfigurations:x}=G(),[d,r]=y.useState(!1),{resolvedTheme:I}=B(),i=a?.IS_GITHUB_ENABLED??"";k("INSTANCE_CONFIGURATIONS",()=>g());const m=async(u,p)=>{r(!0);const f={[u]:p},h=x(f);U(h,{loading:"Saving Configuration...",success:{title:"Configuration saved",message:()=>`GitHub authentication is now ${p==="1"?"active":"disabled"}.`},error:{title:"Error",message:()=>"Failed to save configuration"}}),await h.then(()=>{r(!1)}).catch(b=>{console.error(b),r(!1)})},o=i==="1";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"relative container mx-auto w-full h-full p-4 py-4 space-y-6 flex flex-col",children:[e.jsx("div",{className:"border-b border-custom-border-100 mx-4 py-4 space-y-1 flex-shrink-0",children:e.jsx(F,{name:"GitHub",description:"Allow members to login or sign up to plane with their GitHub accounts.",icon:e.jsx("img",{src:L(I)==="dark"?O:R,height:24,width:24,alt:"GitHub Logo"}),config:e.jsx(A,{value:o,onChange:()=>{m("IS_GITHUB_ENABLED",o?"0":"1")},size:"sm",disabled:d||!a}),disabled:d||!a,withBorder:!1})}),e.jsx("div",{className:"flex-grow overflow-hidden overflow-y-scroll vertical-scrollbar scrollbar-md px-4",children:a?e.jsx($,{config:a}):e.jsxs(s,{className:"space-y-8",children:[e.jsx(s.Item,{height:"50px",width:"25%"}),e.jsx(s.Item,{height:"50px"}),e.jsx(s.Item,{height:"50px"}),e.jsx(s.Item,{height:"50px"}),e.jsx(s.Item,{height:"50px",width:"50%"})]})})]})})}),be=()=>[{title:"GitHub Authentication - God Mode"}],Te=v(J);export{Te as default,be as meta};
