{"version":3,"file":"index.js","names":["React","BaseMenu"],"sources":["../../src/menu/menu.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Menu as BaseMenu } from \"@base-ui-components/react/menu\";\nimport { MoreHorizontal } from \"lucide-react\";\nimport { ChevronDownIcon, ChevronRightIcon } from \"../icons\";\nimport { cn } from \"../utils/classname\";\nimport type { TMenuProps, TSubMenuProps, TMenuItemProps } from \"./types\";\n\n// Context for main menu to communicate with submenus\nconst MenuContext = React.createContext<{\n  closeAllSubmenus: () => void;\n  registerSubmenu: (closeSubmenu: () => void) => () => void;\n} | null>(null);\n\n// SubMenu context for closing submenu from nested items\nconst SubMenuContext = React.createContext<{ closeSubmenu: () => void } | null>(null);\n\n// Hook to use submenu context\nconst useSubMenu = () => React.useContext(SubMenuContext);\n\n// SubMenu implementation\nfunction SubMenu(props: TSubMenuProps) {\n  const { children, trigger, disabled = false, className = \"\" } = props;\n\n  return (\n    <BaseMenu.SubmenuRoot disabled={disabled}>\n      <BaseMenu.SubmenuTrigger className={\"\"}>\n        <span className=\"flex-1\">{trigger}</span>\n        <ChevronRightIcon />\n      </BaseMenu.SubmenuTrigger>\n      <BaseMenu.Portal>\n        <BaseMenu.Positioner className={\"\"} alignOffset={-4} sideOffset={-4}>\n          <BaseMenu.Popup className={className}>{children} </BaseMenu.Popup>\n        </BaseMenu.Positioner>\n      </BaseMenu.Portal>\n    </BaseMenu.SubmenuRoot>\n  );\n}\n\nfunction MenuItem(props: TMenuItemProps) {\n  const { children, disabled = false, onClick, className } = props;\n  const submenuContext = useSubMenu();\n\n  return (\n    <BaseMenu.Item\n      disabled={disabled}\n      className={cn(\n        \"w-full select-none truncate rounded px-1 py-1.5 text-left text-custom-text-200 hover:bg-custom-background-80 cursor-pointer outline-none\",\n        {\n          \"text-custom-text-400\": disabled,\n        },\n        className\n      )}\n      onClick={(e) => {\n        close();\n        onClick?.(e);\n        submenuContext?.closeSubmenu();\n      }}\n    >\n      {children}\n    </BaseMenu.Item>\n  );\n}\n\nfunction Menu(props: TMenuProps) {\n  const {\n    ariaLabel,\n    buttonClassName = \"\",\n    customButtonClassName = \"\",\n    customButtonTabIndex = 0,\n    children,\n    customButton,\n    disabled = false,\n    ellipsis = false,\n    label,\n    maxHeight = \"md\",\n    noBorder = false,\n    noChevron = false,\n    optionsClassName = \"\",\n    menuItemsClassName = \"\",\n    verticalEllipsis = false,\n    menuButtonOnClick,\n    onMenuClose,\n    tabIndex,\n    openOnHover = false,\n    handleOpenChange = () => {},\n  } = props;\n\n  const [isOpen, setIsOpen] = React.useState(false);\n  // refs\n  const submenuClosersRef = React.useRef<Set<() => void>>(new Set());\n\n  const closeAllSubmenus = React.useCallback(() => {\n    submenuClosersRef.current.forEach((closeSubmenu) => closeSubmenu());\n  }, []);\n\n  const registerSubmenu = React.useCallback((closeSubmenu: () => void) => {\n    submenuClosersRef.current.add(closeSubmenu);\n    return () => {\n      submenuClosersRef.current.delete(closeSubmenu);\n    };\n  }, []);\n  const openDropdown = () => {\n    setIsOpen(true);\n  };\n\n  const closeDropdown = React.useCallback(() => {\n    if (isOpen) {\n      closeAllSubmenus();\n      onMenuClose?.();\n    }\n    setIsOpen(false);\n  }, [isOpen, closeAllSubmenus, onMenuClose]);\n\n  const handleMenuButtonClick = (e: React.MouseEvent<HTMLButtonElement, MouseEvent>) => {\n    e.stopPropagation();\n    e.preventDefault();\n    if (isOpen) {\n      closeDropdown();\n    } else {\n      openDropdown();\n    }\n    if (menuButtonOnClick) menuButtonOnClick();\n  };\n\n  return (\n    <BaseMenu.Root openOnHover={openOnHover} onOpenChange={handleOpenChange}>\n      {customButton ? (\n        <BaseMenu.Trigger\n          type=\"button\"\n          onClick={handleMenuButtonClick}\n          className={cn(customButtonClassName, \"outline-none\")}\n          tabIndex={customButtonTabIndex}\n          disabled={disabled}\n          aria-label={ariaLabel}\n        >\n          {customButton}\n        </BaseMenu.Trigger>\n      ) : (\n        <>\n          {ellipsis || verticalEllipsis ? (\n            <BaseMenu.Trigger\n              type=\"button\"\n              onClick={handleMenuButtonClick}\n              disabled={disabled}\n              className={`relative grid place-items-center rounded p-1 text-custom-text-200 outline-none hover:text-custom-text-100 ${\n                disabled ? \"cursor-not-allowed\" : \"cursor-pointer hover:bg-custom-background-80\"\n              } ${buttonClassName}`}\n              tabIndex={customButtonTabIndex}\n              aria-label={ariaLabel}\n            >\n              <MoreHorizontal className={`h-3.5 w-3.5 ${verticalEllipsis ? \"rotate-90\" : \"\"}`} />\n            </BaseMenu.Trigger>\n          ) : (\n            <BaseMenu.Trigger\n              type=\"button\"\n              className={`flex items-center justify-between gap-1 whitespace-nowrap rounded-md px-2.5 py-1 text-xs duration-300 outline-none ${\n                isOpen ? \"bg-custom-background-90 text-custom-text-100\" : \"text-custom-text-200\"\n              } ${noBorder ? \"\" : \"border border-custom-border-300 shadow-sm focus:outline-none\"} ${\n                disabled ? \"cursor-not-allowed text-custom-text-200\" : \"cursor-pointer hover:bg-custom-background-80\"\n              } ${buttonClassName}`}\n              onClick={handleMenuButtonClick}\n              tabIndex={customButtonTabIndex}\n              disabled={disabled}\n              aria-label={ariaLabel}\n            >\n              {label}\n              {!noChevron && <ChevronDownIcon className=\"h-3.5 w-3.5\" />}\n            </BaseMenu.Trigger>\n          )}\n        </>\n      )}\n      <BaseMenu.Portal>\n        <BaseMenu.Positioner\n          align={\"start\"}\n          className={cn(\n            \"fixed z-30 translate-y-0\",\n            menuItemsClassName\n          )} /** translate-y-0 is a hack to create new stacking context. Required for safari  */\n        >\n          <BaseMenu.Popup\n            tabIndex={tabIndex}\n            className={cn(\n              \"my-1 overflow-y-scroll rounded-md border-[0.5px] border-custom-border-300 bg-custom-background-100 px-2 py-2.5 text-xs shadow-custom-shadow-rg focus:outline-none min-w-[12rem] whitespace-nowrap\",\n              {\n                \"max-h-60\": maxHeight === \"lg\",\n                \"max-h-48\": maxHeight === \"md\",\n                \"max-h-36\": maxHeight === \"rg\",\n                \"max-h-28\": maxHeight === \"sm\",\n              },\n              optionsClassName\n            )}\n            data-main-menu=\"true\"\n          >\n            <MenuContext.Provider value={{ closeAllSubmenus, registerSubmenu }}>{children}</MenuContext.Provider>\n          </BaseMenu.Popup>\n        </BaseMenu.Positioner>\n      </BaseMenu.Portal>\n    </BaseMenu.Root>\n  );\n}\n\nMenu.MenuItem = MenuItem;\nMenu.SubMenu = SubMenu;\n\nexport { Menu };\n"],"mappings":"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"}