{"version":3,"file":"index.js","names":["MAX_HEIGHT_CLASSES: Record<TMaxHeight, string>","React","BaseCombobox","ComboboxButton"],"sources":["../../src/combobox/combobox.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { Combobox as BaseCombobox } from \"@base-ui-components/react/combobox\";\nimport { Search } from \"lucide-react\";\nimport { cn } from \"../utils/classname\";\n\n// Type definitions\ntype TMaxHeight = \"lg\" | \"md\" | \"rg\" | \"sm\";\n\nexport interface ComboboxProps {\n  value?: string | string[];\n  defaultValue?: string | string[];\n  onValueChange?: (value: string | string[]) => void;\n  multiSelect?: boolean;\n  maxSelections?: number;\n  disabled?: boolean;\n  open?: boolean;\n  onOpenChange?: (open: boolean) => void;\n  children: React.ReactNode;\n}\n\nexport interface ComboboxButtonProps {\n  disabled?: boolean;\n  children?: React.ReactNode;\n  className?: string;\n  ref?: React.Ref<HTMLButtonElement>;\n}\n\nexport interface ComboboxOptionsProps {\n  searchPlaceholder?: string;\n  emptyMessage?: string;\n  showSearch?: boolean;\n  className?: string;\n  children?: React.ReactNode;\n  maxHeight?: TMaxHeight;\n  inputClassName?: string;\n  optionsContainerClassName?: string;\n  positionerClassName?: string;\n  searchQuery?: string;\n  onSearchQueryChange?: (query: string) => void;\n  onSearchQueryKeyDown?: (e: React.KeyboardEvent<HTMLInputElement>) => void;\n  dataPreventOutsideClick?: boolean;\n}\n\nexport interface ComboboxOptionProps {\n  value: string;\n  disabled?: boolean;\n  children?: React.ReactNode;\n  className?: string;\n}\n\n// Constants\nconst MAX_HEIGHT_CLASSES: Record<TMaxHeight, string> = {\n  lg: \"max-h-60\",\n  md: \"max-h-48\",\n  rg: \"max-h-36\",\n  sm: \"max-h-28\",\n} as const;\n\n// Root component\nfunction ComboboxRoot({\n  value,\n  defaultValue,\n  onValueChange,\n  multiSelect = false,\n  disabled = false,\n  open,\n  onOpenChange,\n  children,\n}: ComboboxProps) {\n  const handleValueChange = React.useCallback(\n    (newValue: string | string[]) => {\n      onValueChange?.(newValue);\n    },\n    [onValueChange]\n  );\n\n  return (\n    <BaseCombobox.Root\n      value={value}\n      defaultValue={defaultValue}\n      onValueChange={handleValueChange}\n      multiple={multiSelect}\n      disabled={disabled}\n      open={open}\n      onOpenChange={onOpenChange}\n    >\n      {children}\n    </BaseCombobox.Root>\n  );\n}\n\n// Trigger button component\nconst ComboboxButton = React.forwardRef(function ComboboxButton(\n  { className, children, disabled = false }: ComboboxButtonProps,\n  ref: React.ForwardedRef<HTMLButtonElement>\n) {\n  return (\n    <BaseCombobox.Trigger ref={ref} disabled={disabled} className={className}>\n      {children}\n    </BaseCombobox.Trigger>\n  );\n});\n\n// Options popup component\nfunction ComboboxOptions({\n  children,\n  showSearch = false,\n  searchPlaceholder,\n  maxHeight = \"lg\",\n  className,\n  inputClassName,\n  optionsContainerClassName,\n  emptyMessage = \"No results found\",\n  positionerClassName,\n  searchQuery: controlledSearchQuery,\n  onSearchQueryChange,\n  onSearchQueryKeyDown,\n  dataPreventOutsideClick,\n}: ComboboxOptionsProps) {\n  // const [searchQuery, setSearchQuery] = React.useState(\"\");\n  const [internalSearchQuery, setInternalSearchQuery] = React.useState(\"\");\n\n  const searchQuery = controlledSearchQuery !== undefined ? controlledSearchQuery : internalSearchQuery;\n\n  const setSearchQuery = React.useCallback(\n    (query: string) => {\n      if (onSearchQueryChange) {\n        onSearchQueryChange(query);\n      } else {\n        setInternalSearchQuery(query);\n      }\n    },\n    [onSearchQueryChange]\n  );\n\n  // Filter children based on search query\n  const filteredChildren = React.useMemo(() => {\n    if (!showSearch || !searchQuery) return children;\n\n    return React.Children.toArray(children).filter((child) => {\n      if (!React.isValidElement(child)) return true;\n\n      // Only filter ComboboxOption components, leave other elements (like additional content) unfiltered\n      if (child.type !== ComboboxOption) return true;\n\n      // Extract text content from child to search against\n      const getTextContent = (node: React.ReactNode): string => {\n        if (typeof node === \"string\") return node;\n        if (typeof node === \"number\") return String(node);\n        if (React.isValidElement(node) && node.props.children) {\n          return getTextContent(node.props.children);\n        }\n        if (Array.isArray(node)) {\n          return node.map(getTextContent).join(\" \");\n        }\n        return \"\";\n      };\n\n      const textContent = getTextContent(child.props.children);\n      const value = child.props.value || \"\";\n\n      const searchLower = searchQuery.toLowerCase();\n      return textContent.toLowerCase().includes(searchLower) || String(value).toLowerCase().includes(searchLower);\n    });\n  }, [children, searchQuery, showSearch]);\n\n  return (\n    <BaseCombobox.Portal>\n      <BaseCombobox.Positioner sideOffset={8} className={positionerClassName}>\n        <BaseCombobox.Popup\n          className={cn(\"rounded-md border border-custom-border-200 bg-custom-background-100 p-1 shadow-lg\", className)}\n          data-prevent-outside-click={dataPreventOutsideClick}\n        >\n          <div className=\"flex flex-col gap-1\">\n            {showSearch && (\n              <div className=\"relative\">\n                <Search className=\"absolute left-2 top-1/2 h-4 w-4 -translate-y-1/2 text-custom-text-400\" />\n                <input\n                  type=\"text\"\n                  placeholder={searchPlaceholder}\n                  value={searchQuery}\n                  onChange={(e) => setSearchQuery(e.target.value)}\n                  onKeyDown={onSearchQueryKeyDown}\n                  className={cn(\n                    \"w-full rounded border border-custom-border-100 bg-custom-background-90 py-1.5 pl-8 pr-2 text-sm outline-none placeholder:text-custom-text-400\",\n                    inputClassName\n                  )}\n                />\n              </div>\n            )}\n            <BaseCombobox.List\n              className={cn(\"overflow-auto outline-none\", MAX_HEIGHT_CLASSES[maxHeight], optionsContainerClassName)}\n            >\n              {filteredChildren}\n              {showSearch &&\n                emptyMessage &&\n                React.Children.count(\n                  React.Children.toArray(filteredChildren).filter(\n                    (child) => React.isValidElement(child) && child.type === ComboboxOption\n                  )\n                ) === 0 && <div className=\"px-2 py-1.5 text-sm text-custom-text-400\">{emptyMessage}</div>}\n            </BaseCombobox.List>\n          </div>\n        </BaseCombobox.Popup>\n      </BaseCombobox.Positioner>\n    </BaseCombobox.Portal>\n  );\n}\n\n// Individual option component\nfunction ComboboxOption({ value, children, disabled, className }: ComboboxOptionProps) {\n  return (\n    <BaseCombobox.Item\n      value={value}\n      disabled={disabled}\n      className={cn(\"cursor-pointer rounded px-2 py-1.5 text-sm outline-none transition-colors\", className)}\n    >\n      {children}\n    </BaseCombobox.Item>\n  );\n}\n\n// Compound component export\nconst Combobox = Object.assign(ComboboxRoot, {\n  Button: ComboboxButton,\n  Options: ComboboxOptions,\n  Option: ComboboxOption,\n});\n\nexport { Combobox };\n"],"mappings":"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"}