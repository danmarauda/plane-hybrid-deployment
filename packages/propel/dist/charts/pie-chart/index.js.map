{"version":3,"file":"index.js","names":["CustomActiveShape","CustomPieChartTooltip","PieChart","CorePieChart","props","key: string | undefined"],"sources":["../../../src/charts/pie-chart/active-shape.tsx","../../../src/charts/pie-chart/tooltip.tsx","../../../src/charts/pie-chart/root.tsx"],"sourcesContent":["import React from \"react\";\nimport { Sector } from \"recharts\";\nimport type { PieSectorDataItem } from \"recharts/types/polar/Pie\";\n\nexport const CustomActiveShape = React.memo(function CustomActiveShape(props: PieSectorDataItem) {\n  const { cx, cy, cornerRadius, innerRadius, outerRadius, startAngle, endAngle, fill } = props;\n\n  return (\n    <g>\n      <Sector\n        cx={cx}\n        cy={cy}\n        innerRadius={innerRadius}\n        outerRadius={outerRadius}\n        cornerRadius={cornerRadius}\n        startAngle={startAngle}\n        endAngle={endAngle}\n        fill={fill}\n      />\n      <Sector\n        cx={cx}\n        cy={cy}\n        startAngle={startAngle}\n        endAngle={endAngle}\n        cornerRadius={cornerRadius}\n        innerRadius={(outerRadius ?? 0) + 6}\n        outerRadius={(outerRadius ?? 0) + 10}\n        fill={fill}\n      />\n    </g>\n  );\n});\n","import React from \"react\";\nimport type { NameType, Payload, ValueType } from \"recharts/types/component/DefaultTooltipContent\";\n// plane imports\nimport { Card, ECardSpacing } from \"../../card\";\n\ntype Props = {\n  dotColor?: string;\n  label: string;\n  payload: Payload<ValueType, NameType>[];\n};\n\nexport const CustomPieChartTooltip = React.memo(function CustomPieChartTooltip(props: Props) {\n  const { dotColor, label, payload } = props;\n\n  return (\n    <Card\n      className=\"flex flex-col max-h-[40vh] w-[12rem] overflow-y-scroll vertical-scrollbar scrollbar-sm\"\n      spacing={ECardSpacing.SM}\n    >\n      <p className=\"flex-shrink-0 text-xs text-custom-text-100 font-medium border-b border-custom-border-200 pb-2 truncate\">\n        {label}\n      </p>\n      {payload?.map((item) => (\n        <div key={item?.dataKey} className=\"flex items-center gap-2 text-xs capitalize\">\n          <div className=\"flex items-center gap-2 truncate\">\n            <div\n              className=\"flex-shrink-0 size-2 rounded-sm\"\n              style={{\n                backgroundColor: dotColor,\n              }}\n            />\n            <span className=\"text-custom-text-300 truncate\">{item?.name}:</span>\n          </div>\n          <span className=\"flex-shrink-0 font-medium text-custom-text-200\">{item?.value}</span>\n        </div>\n      ))}\n    </Card>\n  );\n});\nCustomPieChartTooltip.displayName = \"CustomPieChartTooltip\";\n","import React, { useMemo, useState } from \"react\";\nimport { Cell, PieChart as CorePieChart, Label, Legend, Pie, ResponsiveContainer, Tooltip } from \"recharts\";\n// plane imports\nimport type { TPieChartProps } from \"@plane/types\";\n// local components\nimport { getLegendProps } from \"../components/legend\";\nimport { CustomActiveShape } from \"./active-shape\";\nimport { CustomPieChartTooltip } from \"./tooltip\";\n\nexport const PieChart = React.memo(function PieChart<K extends string, T extends string>(props: TPieChartProps<K, T>) {\n  const {\n    data,\n    dataKey,\n    cells,\n    className,\n    innerRadius,\n    legend,\n    margin,\n    outerRadius,\n    showTooltip = true,\n    showLabel,\n    customLabel,\n    centerLabel,\n    cornerRadius,\n    paddingAngle,\n    tooltipLabel,\n  } = props;\n  // states\n  const [activeIndex, setActiveIndex] = useState<number | null>(null);\n  const [activeLegend, setActiveLegend] = useState<string | null>(null);\n\n  const renderCells = useMemo(\n    () =>\n      cells.map((cell, index) => (\n        <Cell\n          key={cell.key}\n          className=\"transition-opacity duration-200\"\n          fill={cell.fill}\n          opacity={!!activeLegend && activeLegend !== cell.key ? 0.1 : 1}\n          style={{\n            outline: \"none\",\n          }}\n          onMouseEnter={() => setActiveIndex(index)}\n          onMouseLeave={() => setActiveIndex(null)}\n        />\n      )),\n    [activeLegend, cells]\n  );\n\n  return (\n    <div className={className}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <CorePieChart\n          data={data}\n          margin={{\n            top: margin?.top === undefined ? 5 : margin.top,\n            right: margin?.right === undefined ? 30 : margin.right,\n            bottom: margin?.bottom === undefined ? 5 : margin.bottom,\n            left: margin?.left === undefined ? 20 : margin.left,\n          }}\n        >\n          <Pie\n            activeIndex={activeIndex === null ? undefined : activeIndex}\n            onMouseLeave={() => setActiveIndex(null)}\n            data={data}\n            dataKey={dataKey}\n            cx=\"50%\"\n            cy=\"50%\"\n            blendStroke\n            activeShape={<CustomActiveShape />}\n            innerRadius={innerRadius}\n            outerRadius={outerRadius}\n            cornerRadius={cornerRadius}\n            paddingAngle={paddingAngle}\n            labelLine={false}\n            label={\n              showLabel\n                ? ({ payload, ...props }) => (\n                    <text\n                      className=\"text-sm font-medium transition-opacity duration-200\"\n                      cx={props.cx}\n                      cy={props.cy}\n                      x={props.x}\n                      y={props.y}\n                      textAnchor={props.textAnchor}\n                      dominantBaseline={props.dominantBaseline}\n                      fill=\"rgba(var(--color-text-200))\"\n                      opacity={!!activeLegend && activeLegend !== payload.key ? 0.1 : 1}\n                    >\n                      {customLabel?.(payload.count) ?? payload.count}\n                    </text>\n                  )\n                : undefined\n            }\n          >\n            {renderCells}\n            {centerLabel && (\n              <Label\n                value={centerLabel.text}\n                fill={centerLabel.fill}\n                position=\"center\"\n                opacity={activeLegend ? 0.1 : 1}\n                style={centerLabel.style}\n                className={centerLabel.className}\n              />\n            )}\n          </Pie>\n          {legend && (\n            // @ts-expect-error recharts types are not up to date\n            <Legend\n              onMouseEnter={(payload) => {\n                // @ts-expect-error recharts types are not up to date\n                const key: string | undefined = payload.payload?.key;\n                if (!key) return;\n                setActiveLegend(key);\n                setActiveIndex(null);\n              }}\n              onMouseLeave={() => setActiveLegend(null)}\n              {...getLegendProps(legend)}\n            />\n          )}\n          {showTooltip && (\n            <Tooltip\n              cursor={{\n                fill: \"currentColor\",\n                className: \"text-custom-background-90/80 cursor-pointer\",\n              }}\n              wrapperStyle={{\n                pointerEvents: \"none\",\n              }}\n              content={({ active, payload }) => {\n                if (!active || !payload || !payload.length) return null;\n                const cellData = cells.find((c) => c.key === payload[0].payload.key);\n                if (!cellData) return null;\n                const label = tooltipLabel\n                  ? typeof tooltipLabel === \"function\"\n                    ? tooltipLabel(payload[0]?.payload?.payload)\n                    : tooltipLabel\n                  : dataKey;\n                return <CustomPieChartTooltip dotColor={cellData.fill} label={label} payload={payload} />;\n              }}\n            />\n          )}\n        </CorePieChart>\n      </ResponsiveContainer>\n    </div>\n  );\n});\nPieChart.displayName = \"PieChart\";\n"],"mappings":"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"}