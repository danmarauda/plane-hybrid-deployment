{"version":3,"file":"index.js","names":["AreaChart","keys: string[]","labels: Record<string, string>","colors: Record<string, string>","props"],"sources":["../../../src/charts/area-chart/root.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\nimport { Area, Legend, ResponsiveContainer, Tooltip, XAxis, YAxis, Line, ComposedChart, CartesianGrid } from \"recharts\";\n// plane imports\nimport { AXIS_LABEL_CLASSNAME } from \"@plane/constants\";\nimport type { TAreaChartProps } from \"@plane/types\";\n// local components\nimport { getLegendProps } from \"../components/legend\";\nimport { CustomXAxisTick, CustomYAxisTick } from \"../components/tick\";\nimport { CustomTooltip } from \"../components/tooltip\";\n\nexport const AreaChart = React.memo(function AreaChart<K extends string, T extends string>(\n  props: TAreaChartProps<K, T>\n) {\n  const {\n    data,\n    areas,\n    xAxis,\n    yAxis,\n    className,\n    legend,\n    margin,\n    tickCount = {\n      x: undefined,\n      y: 10,\n    },\n    customTicks,\n    showTooltip = true,\n    comparisonLine,\n  } = props;\n  // states\n  const [activeArea, setActiveArea] = useState<string | null>(null);\n  const [activeLegend, setActiveLegend] = useState<string | null>(null);\n\n  // derived values\n  const { itemKeys, itemLabels, itemDotColors } = useMemo(() => {\n    const keys: string[] = [];\n    const labels: Record<string, string> = {};\n    const colors: Record<string, string> = {};\n\n    for (const area of areas) {\n      keys.push(area.key);\n      labels[area.key] = area.label;\n      colors[area.key] = area.fill;\n    }\n\n    return { itemKeys: keys, itemLabels: labels, itemDotColors: colors };\n  }, [areas]);\n\n  const renderAreas = useMemo(\n    () =>\n      areas.map((area) => (\n        <Area\n          key={area.key}\n          type={area.smoothCurves ? \"monotone\" : \"linear\"}\n          dataKey={area.key}\n          stackId={area.stackId}\n          fill={area.fill}\n          opacity={!!activeLegend && activeLegend !== area.key ? 0.1 : 1}\n          fillOpacity={area.fillOpacity}\n          strokeOpacity={area.strokeOpacity}\n          stroke={area.strokeColor}\n          strokeWidth={2}\n          style={area.style}\n          dot={\n            area.showDot\n              ? {\n                  fill: area.fill,\n                  fillOpacity: 1,\n                }\n              : false\n          }\n          activeDot={{\n            stroke: area.fill,\n          }}\n          onMouseEnter={() => setActiveArea(area.key)}\n          onMouseLeave={() => setActiveArea(null)}\n          className=\"[&_path]:transition-opacity [&_path]:duration-200\"\n        />\n      )),\n    [activeLegend, areas]\n  );\n\n  // create comparison line data for straight line from origin to last point\n  const comparisonLineData = useMemo(() => {\n    if (!data || data.length === 0) return [];\n    // get the last data point\n    const lastPoint = data[data.length - 1];\n    // for the y-value in the last point, use its yAxis key value\n    const lastYValue = lastPoint[yAxis.key] ?? 0;\n    // create data for a straight line that has points at each x-axis position\n    return data.map((item, index) => {\n      // calculate the y value for this point on the straight line\n      // using linear interpolation between (0,0) and (last_x, last_y)\n      const ratio = index / (data.length - 1);\n      const interpolatedValue = ratio * lastYValue;\n\n      return {\n        [xAxis.key]: item[xAxis.key],\n        comparisonLine: interpolatedValue,\n      };\n    });\n  }, [data, xAxis.key, yAxis.key]);\n  return (\n    <div className={className}>\n      <ResponsiveContainer width=\"100%\" height=\"100%\">\n        <ComposedChart\n          data={data}\n          margin={{\n            top: margin?.top === undefined ? 5 : margin.top,\n            right: margin?.right === undefined ? 30 : margin.right,\n            bottom: margin?.bottom === undefined ? 5 : margin.bottom,\n            left: margin?.left === undefined ? 20 : margin.left,\n          }}\n        >\n          <CartesianGrid stroke=\"rgba(var(--color-border-100), 0.8)\" vertical={false} />\n          <XAxis\n            dataKey={xAxis.key}\n            tick={(props) => {\n              const TickComponent = customTicks?.x || CustomXAxisTick;\n              return <TickComponent {...props} />;\n            }}\n            tickLine={false}\n            axisLine={false}\n            label={\n              xAxis.label && {\n                value: xAxis.label,\n                dy: 28,\n                className: AXIS_LABEL_CLASSNAME,\n              }\n            }\n            tickCount={tickCount.x}\n          />\n          <YAxis\n            domain={yAxis.domain}\n            tickLine={false}\n            axisLine={false}\n            label={\n              yAxis.label && {\n                value: yAxis.label,\n                angle: -90,\n                position: \"bottom\",\n                offset: yAxis.offset ?? -24,\n                dx: yAxis.dx ?? -16,\n                className: AXIS_LABEL_CLASSNAME,\n              }\n            }\n            tick={(props) => {\n              const TickComponent = customTicks?.y || CustomYAxisTick;\n              return <TickComponent {...props} />;\n            }}\n            tickCount={tickCount.y}\n            allowDecimals={!!yAxis.allowDecimals}\n          />\n          {legend && (\n            // @ts-expect-error recharts types are not up to date\n            <Legend\n              formatter={(value) => itemLabels[value]}\n              onMouseEnter={(payload) => setActiveLegend(payload.value)}\n              onMouseLeave={() => setActiveLegend(null)}\n              {...getLegendProps(legend)}\n            />\n          )}\n          {showTooltip && (\n            <Tooltip\n              cursor={{\n                stroke: \"rgba(var(--color-text-300))\",\n                strokeDasharray: \"4 4\",\n              }}\n              wrapperStyle={{\n                pointerEvents: \"auto\",\n              }}\n              content={({ active, label, payload }) => (\n                <CustomTooltip\n                  active={active}\n                  activeKey={activeArea}\n                  label={label}\n                  payload={payload}\n                  itemKeys={itemKeys}\n                  itemLabels={itemLabels}\n                  itemDotColors={itemDotColors}\n                />\n              )}\n            />\n          )}\n          {renderAreas}\n          {comparisonLine && (\n            <Line\n              data={comparisonLineData}\n              type=\"linear\"\n              dataKey=\"comparisonLine\"\n              stroke={comparisonLine.strokeColor}\n              fill={comparisonLine.strokeColor}\n              strokeWidth={2}\n              strokeDasharray={comparisonLine.dashedLine ? \"4 4\" : \"none\"}\n              activeDot={false}\n              legendType=\"none\"\n              name=\"Comparison line\"\n            />\n          )}\n        </ComposedChart>\n      </ResponsiveContainer>\n    </div>\n  );\n});\nAreaChart.displayName = \"AreaChart\";\n"],"mappings":"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"}